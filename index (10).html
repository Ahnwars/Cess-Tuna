<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cess Tuna ‚Äî Burgers & Fast Food</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:wght@400;500;600&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
<style>
  :root { --red:#E8272B; --yellow:#FFD600; --dark:#111111; --gray:#1C1C1C; --light:#F5F0E8; --muted:#888; }
  * { margin:0; padding:0; box-sizing:border-box; }
  body { background:var(--dark); color:var(--light); font-family:'DM Sans',sans-serif; overflow-x:hidden; }

  nav { display:flex; justify-content:space-between; align-items:center; padding:18px 40px; position:sticky; top:0; z-index:100; background:rgba(17,17,17,0.95); backdrop-filter:blur(10px); border-bottom:2px solid var(--red); }
  .logo { font-family:'Bebas Neue',sans-serif; font-size:2rem; letter-spacing:3px; color:var(--yellow); text-shadow:2px 2px 0 var(--red); }
  .nav-links a { color:var(--light); text-decoration:none; margin-left:28px; font-weight:600; font-size:0.9rem; letter-spacing:1px; text-transform:uppercase; transition:color 0.2s; }
  .nav-links a:hover { color:var(--yellow); }
  .cart-btn { background:var(--red); color:#fff; border:none; padding:10px 22px; border-radius:4px; font-family:'DM Sans',sans-serif; font-weight:600; cursor:pointer; font-size:0.9rem; letter-spacing:1px; transition:background 0.2s,transform 0.1s; position:relative; }
  .cart-btn:hover { background:#c41e21; transform:scale(1.04); }
  .cart-count { position:absolute; top:-8px; right:-8px; background:var(--yellow); color:var(--dark); border-radius:50%; width:20px; height:20px; font-size:0.75rem; font-weight:700; display:none; align-items:center; justify-content:center; }

  .hero { min-height:85vh; display:flex; align-items:center; padding:60px 40px; position:relative; overflow:hidden; }
  .hero::before { content:''; position:absolute; inset:0; background:radial-gradient(ellipse at 70% 50%,rgba(232,39,43,0.15) 0%,transparent 60%),radial-gradient(ellipse at 20% 80%,rgba(255,214,0,0.08) 0%,transparent 50%); }
  .hero-text { position:relative; z-index:2; max-width:600px; }
  .hero-badge { display:inline-block; background:var(--red); color:#fff; padding:6px 14px; border-radius:2px; font-size:0.75rem; font-weight:600; letter-spacing:2px; text-transform:uppercase; margin-bottom:20px; animation:pulse 2s infinite; }
  @keyframes pulse { 0%,100%{opacity:1} 50%{opacity:0.7} }
  .hero h1 { font-family:'Bebas Neue',sans-serif; font-size:clamp(4rem,10vw,8rem); line-height:0.9; letter-spacing:2px; margin-bottom:24px; }
  .hero h1 span { color:var(--yellow); }
  .hero p { font-size:1.1rem; color:#aaa; line-height:1.6; margin-bottom:36px; max-width:420px; }
  .hero-cta { display:inline-block; background:var(--yellow); color:var(--dark); padding:16px 40px; border-radius:4px; font-weight:700; font-size:1rem; letter-spacing:1px; text-transform:uppercase; transition:transform 0.2s,box-shadow 0.2s; cursor:pointer; border:none; font-family:'DM Sans',sans-serif; }
  .hero-cta:hover { transform:translateY(-3px); box-shadow:0 8px 25px rgba(255,214,0,0.3); }
  .hero-img { position:absolute; right:-40px; top:50%; transform:translateY(-50%); font-size:18rem; opacity:0.08; pointer-events:none; user-select:none; }

  section { padding:80px 40px; }
  .section-title { font-family:'Bebas Neue',sans-serif; font-size:3rem; letter-spacing:3px; margin-bottom:8px; }
  .section-title span { color:var(--red); }
  .section-sub { color:var(--muted); margin-bottom:48px; font-size:0.95rem; }

  .tabs { display:flex; gap:12px; margin-bottom:40px; flex-wrap:wrap; }
  .tab { padding:10px 24px; background:var(--gray); border:2px solid transparent; border-radius:4px; color:var(--muted); font-weight:600; font-size:0.85rem; letter-spacing:1px; text-transform:uppercase; cursor:pointer; transition:all 0.2s; font-family:'DM Sans',sans-serif; }
  .tab.active,.tab:hover { border-color:var(--red); color:var(--light); background:rgba(232,39,43,0.1); }

  .menu-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(260px,1fr)); gap:24px; }
  .menu-card { background:var(--gray); border-radius:8px; overflow:hidden; border:1px solid #2a2a2a; transition:transform 0.2s,border-color 0.2s; animation:fadeUp 0.4s ease both; }
  @keyframes fadeUp { from{opacity:0;transform:translateY(20px)} to{opacity:1;transform:translateY(0)} }
  .menu-card:hover { transform:translateY(-6px); border-color:var(--red); }
  .card-img { width:100%; height:160px; display:flex; align-items:center; justify-content:center; font-size:5rem; background:#252525; }
  .card-body { padding:18px; }
  .card-name { font-weight:700; font-size:1.05rem; margin-bottom:6px; }
  .card-desc { color:var(--muted); font-size:0.85rem; line-height:1.5; margin-bottom:16px; }
  .card-footer { display:flex; align-items:center; justify-content:space-between; }
  .card-price { font-family:'Bebas Neue',sans-serif; font-size:1.6rem; color:var(--yellow); letter-spacing:1px; }
  .add-btn { background:var(--red); color:#fff; border:none; width:36px; height:36px; border-radius:4px; font-size:1.4rem; cursor:pointer; transition:background 0.2s,transform 0.1s; display:flex; align-items:center; justify-content:center; font-family:monospace; }
  .add-btn:hover { background:#c41e21; transform:scale(1.1); }

  .cart-overlay { position:fixed; inset:0; background:rgba(0,0,0,0.7); z-index:200; opacity:0; pointer-events:none; transition:opacity 0.3s; }
  .cart-overlay.open { opacity:1; pointer-events:all; }
  .cart-sidebar { position:fixed; right:-440px; top:0; width:420px; max-width:100vw; height:100%; background:#161616; z-index:201; transition:right 0.35s cubic-bezier(0.4,0,0.2,1); display:flex; flex-direction:column; border-left:2px solid var(--red); }
  .cart-sidebar.open { right:0; }
  .cart-header { padding:24px; border-bottom:1px solid #2a2a2a; display:flex; justify-content:space-between; align-items:center; }
  .cart-header h2 { font-family:'Bebas Neue',sans-serif; font-size:1.8rem; letter-spacing:2px; }
  .close-cart { background:none; border:none; color:var(--muted); font-size:1.5rem; cursor:pointer; transition:color 0.2s; }
  .close-cart:hover { color:var(--red); }
  .cart-items { flex:1; overflow-y:auto; padding:20px; }
  .cart-item { display:flex; gap:12px; padding:14px 0; border-bottom:1px solid #2a2a2a; align-items:center; }
  .ci-emoji { font-size:2rem; width:44px; text-align:center; }
  .ci-info { flex:1; }
  .ci-name { font-weight:600; font-size:0.95rem; }
  .ci-price { color:var(--yellow); font-size:0.85rem; margin-top:2px; }
  .ci-qty { display:flex; align-items:center; gap:10px; margin-top:8px; }
  .qty-btn { background:#2a2a2a; border:none; color:var(--light); width:26px; height:26px; border-radius:4px; cursor:pointer; font-size:1rem; transition:background 0.2s; }
  .qty-btn:hover { background:var(--red); }
  .qty-num { font-weight:700; font-size:0.95rem; min-width:20px; text-align:center; }
  .empty-cart { text-align:center; color:var(--muted); padding:60px 20px; font-size:1.1rem; }
  .empty-cart .ec-icon { font-size:4rem; margin-bottom:12px; }
  .order-form { padding:20px; border-top:1px solid #2a2a2a; }
  .order-total { display:flex; justify-content:space-between; margin-bottom:16px; font-weight:700; font-size:1.1rem; }
  .order-total span:last-child { color:var(--yellow); font-family:'Bebas Neue',sans-serif; font-size:1.4rem; }
  .form-group { margin-bottom:12px; }
  .form-group input,.form-group textarea { width:100%; background:#2a2a2a; border:1px solid #333; border-radius:4px; padding:12px 14px; color:var(--light); font-family:'DM Sans',sans-serif; font-size:0.9rem; transition:border-color 0.2s; resize:none; }
  .form-group input:focus,.form-group textarea:focus { outline:none; border-color:var(--red); }
  .form-group input::placeholder,.form-group textarea::placeholder { color:var(--muted); }
  .place-order-btn { width:100%; background:var(--red); color:#fff; border:none; padding:16px; border-radius:4px; font-family:'Bebas Neue',sans-serif; font-size:1.3rem; letter-spacing:2px; cursor:pointer; transition:background 0.2s,transform 0.1s; }
  .place-order-btn:hover { background:#c41e21; transform:scale(1.02); }
  .place-order-btn:disabled { background:#555; cursor:not-allowed; transform:none; }

  .toast { position:fixed; bottom:100px; left:50%; transform:translateX(-50%) translateY(100px); background:#1a1a1a; border:2px solid var(--yellow); color:var(--light); padding:16px 28px; border-radius:6px; font-weight:600; font-size:0.95rem; z-index:500; transition:transform 0.4s cubic-bezier(0.4,0,0.2,1); text-align:center; min-width:280px; box-shadow:0 8px 40px rgba(0,0,0,0.5); }
  .toast.show { transform:translateX(-50%) translateY(0); }

  .order-alert { position:fixed; top:0; left:0; right:0; background:var(--red); color:#fff; text-align:center; padding:14px; font-weight:700; font-size:1rem; letter-spacing:1px; z-index:500; transform:translateY(-100%); transition:transform 0.4s; }
  .order-alert.show { transform:translateY(0); }

  /* SHUTDOWN OVERLAY */
  .shutdown-overlay { position:fixed; inset:0; background:#090909; z-index:9999; display:none; flex-direction:column; align-items:center; justify-content:center; text-align:center; padding:40px; }
  .shutdown-overlay.active { display:flex; }
  .shutdown-icon { font-size:5rem; margin-bottom:24px; animation:pulse 2s infinite; }
  .shutdown-title { font-family:'Bebas Neue',sans-serif; font-size:clamp(3rem,8vw,6rem); color:var(--red); letter-spacing:4px; margin-bottom:16px; line-height:1; }
  .shutdown-msg { color:#666; font-size:1.05rem; max-width:440px; line-height:1.7; margin-bottom:32px; }
  .shutdown-badge { display:inline-block; border:2px solid #3a0000; color:#cc3333; padding:10px 28px; border-radius:4px; font-weight:700; font-size:0.85rem; letter-spacing:2px; text-transform:uppercase; }

  /* ORDER STATUS TRACKER */
  .status-tracker {
    position:fixed; bottom:24px; left:50%;
    transform:translateX(-50%) translateY(160px);
    background:#161616; border:2px solid var(--yellow);
    border-radius:14px; padding:18px 24px 14px;
    z-index:400; min-width:300px; max-width:92vw;
    box-shadow:0 8px 40px rgba(0,0,0,0.7);
    transition:transform 0.5s cubic-bezier(0.4,0,0.2,1);
  }
  .status-tracker.show { transform:translateX(-50%) translateY(0); }
  .st-close { position:absolute; top:10px; right:14px; background:none; border:none; color:var(--muted); cursor:pointer; font-size:1rem; line-height:1; }
  .st-close:hover { color:var(--light); }
  .st-order-id { font-size:0.7rem; color:var(--muted); letter-spacing:2px; text-transform:uppercase; text-align:center; margin-bottom:14px; }
  .st-steps { display:flex; align-items:center; justify-content:center; }
  .st-step { display:flex; flex-direction:column; align-items:center; gap:6px; }
  .st-dot { width:36px; height:36px; border-radius:50%; background:#222; border:2px solid #333; display:flex; align-items:center; justify-content:center; font-size:1rem; transition:all 0.4s; }
  .st-dot.done  { background:rgba(255,214,0,0.15); border-color:var(--yellow); }
  .st-dot.active { background:rgba(232,39,43,0.2); border-color:var(--red); animation:pulse 1.5s infinite; box-shadow:0 0 14px rgba(232,39,43,0.4); }
  .st-label { font-size:0.6rem; color:#555; font-weight:700; letter-spacing:0.5px; text-transform:uppercase; text-align:center; max-width:52px; line-height:1.3; }
  .st-label.done   { color:var(--yellow); }
  .st-label.active { color:var(--light); }
  .st-line { width:24px; height:2px; background:#222; margin-bottom:18px; flex-shrink:0; transition:background 0.4s; }
  .st-line.done { background:var(--yellow); }

  footer { background:#0a0a0a; border-top:2px solid #1e1e1e; padding:40px; text-align:center; color:var(--muted); font-size:0.85rem; }
  .footer-logo { font-family:'Bebas Neue',sans-serif; font-size:2.5rem; color:var(--yellow); letter-spacing:4px; text-shadow:2px 2px 0 var(--red); margin-bottom:10px; }

  @media (max-width:600px) {
    nav { padding:14px 20px; }
    .hero { padding:40px 20px; }
    section { padding:60px 20px; }
    .cart-sidebar { width:100vw; }
  }
</style>
</head>
<body>

<!-- SHUTDOWN OVERLAY -->
<div class="shutdown-overlay" id="shutdownOverlay">
  <div class="shutdown-icon">üîí</div>
  <div class="shutdown-title">TEMPORARILY<br>CLOSED</div>
  <p class="shutdown-msg" id="shutdownMsg">We're currently unavailable. Please check back soon or contact us directly.</p>
  <div class="shutdown-badge">‚ö†Ô∏è Service Suspended</div>
</div>

<!-- ORDER ALERT BAR -->
<div class="order-alert" id="orderAlert">üéâ Order placed! We'll get it ready now.</div>

<!-- NAV -->
<nav>
  <div class="logo">CESS TUNA</div>
  <div class="nav-links">
    <a href="#menu">Menu</a>
    <a href="#about">About</a>
  </div>
  <button class="cart-btn" onclick="toggleCart()">
    üõí Cart
    <span class="cart-count" id="cartCount">0</span>
  </button>
</nav>

<!-- HERO -->
<div class="hero">
  <div class="hero-text">
    <div class="hero-badge">üî• Now Taking Orders</div>
    <h1>BOLD <span>BURGERS</span><br>FAST FOOD</h1>
    <p>Flame-grilled burgers, crispy fries, and fast food done right. Order now and taste the difference.</p>
    <button class="hero-cta" onclick="document.getElementById('menu').scrollIntoView({behavior:'smooth'})">Order Now</button>
  </div>
  <div class="hero-img">üçî</div>
</div>

<!-- MENU -->
<section id="menu">
  <div class="section-title">OUR <span>MENU</span></div>
  <p class="section-sub">Fresh ingredients. Bold flavors. Every single time.</p>
  <div class="tabs">
    <button class="tab active" onclick="filterMenu('all',this)">All</button>
    <button class="tab" onclick="filterMenu('burgers',this)">Burgers</button>
    <button class="tab" onclick="filterMenu('sides',this)">Sides</button>
    <button class="tab" onclick="filterMenu('drinks',this)">Drinks</button>
    <button class="tab" onclick="filterMenu('combos',this)">Combos</button>
  </div>
  <div class="menu-grid" id="menuGrid"></div>
</section>

<!-- ABOUT -->
<section id="about" style="background:#0d0d0d;margin:0;padding:60px 40px;">
  <div class="section-title">ABOUT <span>US</span></div>
  <p style="color:#aaa;max-width:600px;line-height:1.8;font-size:1rem;">
    Cess Tuna is your go-to spot for mouthwatering burgers and fast food made with love.
    We craft every bite with the freshest ingredients, bold seasoning, and a passion for great food.
    Order online and get it delivered hot to your door!
  </p>
</section>

<!-- FOOTER -->
<footer>
  <div class="footer-logo">CESS TUNA</div>
  <p>Burgers &amp; Fast Food ¬∑ Order Online ¬∑ Fresh Daily</p>
  <p style="margin-top:10px;">¬© 2025 Cess Tuna. All rights reserved.</p>
</footer>

<!-- CART SIDEBAR -->
<div class="cart-overlay" id="cartOverlay" onclick="toggleCart()"></div>
<div class="cart-sidebar" id="cartSidebar">
  <div class="cart-header">
    <h2>üõí YOUR ORDER</h2>
    <button class="close-cart" onclick="toggleCart()">‚úï</button>
  </div>
  <div class="cart-items" id="cartItems">
    <div class="empty-cart"><div class="ec-icon">üõí</div>Your cart is empty.<br>Add some items!</div>
  </div>
  <div class="order-form" id="orderForm" style="display:none;">
    <div class="order-total"><span>Total</span><span id="totalPrice">‚Ç±0.00</span></div>
    <div class="form-group"><input type="text" id="custName" placeholder="Your Name *"></div>
    <div class="form-group"><input type="tel" id="custPhone" placeholder="Phone Number *"></div>
    <div class="form-group"><textarea id="custAddress" rows="2" placeholder="Delivery Address *"></textarea></div>
    <div class="form-group"><textarea id="custNote" rows="2" placeholder="Special instructions (optional)"></textarea></div>
    <button class="place-order-btn" onclick="placeOrder()">PLACE ORDER</button>
  </div>
</div>

<!-- STATUS TRACKER -->
<div class="status-tracker" id="statusTracker">
  <button class="st-close" onclick="closeTracker()">‚úï</button>
  <div class="st-order-id" id="stOrderId">YOUR ORDER</div>
  <div class="st-steps">
    <div class="st-step">
      <div class="st-dot active" id="dot0">üì•</div>
      <div class="st-label active" id="lbl0">Received</div>
    </div>
    <div class="st-line" id="line0"></div>
    <div class="st-step">
      <div class="st-dot" id="dot1">üë®‚Äçüç≥</div>
      <div class="st-label" id="lbl1">Preparing</div>
    </div>
    <div class="st-line" id="line1"></div>
    <div class="st-step">
      <div class="st-dot" id="dot2">üõµ</div>
      <div class="st-label" id="lbl2">On the Way</div>
    </div>
    <div class="st-line" id="line2"></div>
    <div class="st-step">
      <div class="st-dot" id="dot3">‚úÖ</div>
      <div class="st-label" id="lbl3">Delivered</div>
    </div>
  </div>
</div>

<!-- TOAST -->
<div class="toast" id="toast"></div>

<script>
  const EMAILJS_SERVICE_ID  = 'service_r43619y';
  const EMAILJS_TEMPLATE_ID = 'template_sh64h64';
  const EMAILJS_PUBLIC_KEY  = 'ZwFqjsN9CH8r4ca8u';
  const OWNER_EMAIL         = 'ahnnwarlisondra@gmail.com';
  emailjs.init(EMAILJS_PUBLIC_KEY);

  const API_KEY      = '$2a$10$VgEOzGTqUc4FOjCZulSrI.AE50EZQuuiTxtV9ONIyyFYOVTlBCjXK';
  const SHUTDOWN_BIN = '699db35843b1c97be999be52';
  const ORDERS_BIN   = '699db83cd0ea881f40d53452';
  const STATUS_STEPS = ['received','preparing','ontheway','delivered'];

  let cart = [];
  let orderCounter = parseInt(localStorage.getItem('cessTunaOrderCounter') || '1001');
  let trackedOrderId = localStorage.getItem('cessTunaTrackedOrder') || '';
  let trackerInterval = null;

  // ‚îÄ‚îÄ SHUTDOWN CHECK ‚îÄ‚îÄ
  async function checkShutdown() {
    try {
      const res  = await fetch('https://api.jsonbin.io/v3/b/' + SHUTDOWN_BIN + '/latest', { headers:{'X-Master-Key':API_KEY,'X-Access-Key':API_KEY} });
      const data = await res.json();
      const isDown = !!(data.record && data.record.shutdown);
      document.getElementById('shutdownOverlay').classList.toggle('active', isDown);
      const msgEl = document.getElementById('shutdownMsg');
      if (isDown && data.record.reason && data.record.reason.trim() !== '') {
        msgEl.textContent = data.record.reason;
      } else {
        msgEl.textContent = "We're currently unavailable. Please check back soon or contact us directly.";
      }
    } catch(e) {}
  }
  checkShutdown();
  setInterval(checkShutdown, 5000);

  // ‚îÄ‚îÄ MENU ‚îÄ‚îÄ
  const menuItems = [
    {id:1,  name:'Classic Smash Burger',  emoji:'üçî', price:149, desc:'Double smash patty, American cheese, pickles, special sauce.',  category:'burgers'},
    {id:2,  name:'Cess Special Burger',   emoji:'üçî', price:179, desc:'Triple patty, bacon, caramelized onions, jalape√±os.',           category:'burgers'},
    {id:3,  name:'Crispy Chicken Burger', emoji:'üçó', price:159, desc:'Crispy fried chicken, coleslaw, honey mustard.',                category:'burgers'},
    {id:4,  name:'BBQ Bacon Burger',      emoji:'ü•ì', price:169, desc:'Smoky BBQ sauce, crispy bacon, cheddar, onion rings.',          category:'burgers'},
    {id:5,  name:'Mushroom Swiss Burger', emoji:'üçÑ', price:155, desc:'Saut√©ed mushrooms, Swiss cheese, garlic aioli.',                category:'burgers'},
    {id:6,  name:'Crispy Fries',          emoji:'üçü', price:59,  desc:'Golden, salted, perfectly crispy every time.',                 category:'sides'},
    {id:7,  name:'Loaded Fries',          emoji:'üçü', price:89,  desc:'Fries topped with cheese sauce, bacon bits & jalape√±os.',      category:'sides'},
    {id:8,  name:'Onion Rings',           emoji:'üßÖ', price:69,  desc:'Beer-battered, golden-fried onion rings.',                     category:'sides'},
    {id:9,  name:'Coleslaw',              emoji:'ü•ó', price:45,  desc:'Creamy, tangy homemade coleslaw.',                             category:'sides'},
    {id:10, name:'Chocolate Shake',       emoji:'ü•§', price:79,  desc:'Rich, thick hand-spun chocolate milkshake.',                   category:'drinks'},
    {id:11, name:'Strawberry Shake',      emoji:'ü•§', price:79,  desc:'Sweet strawberry milkshake, fresh blended.',                   category:'drinks'},
    {id:12, name:'Iced Lemon Tea',        emoji:'üçã', price:55,  desc:'Refreshing lemon tea over ice.',                               category:'drinks'},
    {id:13, name:'Soda (can)',            emoji:'ü•´', price:40,  desc:'Choice of Coke, Sprite, or Royal.',                            category:'drinks'},
    {id:14, name:'Smash Combo',           emoji:'üç±', price:229, desc:'Classic Smash Burger + Fries + Soda. Best value!',             category:'combos'},
    {id:15, name:'Chicken Combo',         emoji:'üç±', price:239, desc:'Crispy Chicken Burger + Loaded Fries + Shake.',                category:'combos'},
    {id:16, name:'Family Pack',           emoji:'üéâ', price:599, desc:'4 Burgers of choice + 4 Fries + 4 Sodas.',                    category:'combos'},
  ];

  function renderMenu(filter='all') {
    const filtered = filter==='all' ? menuItems : menuItems.filter(i=>i.category===filter);
    document.getElementById('menuGrid').innerHTML = filtered.map((item,idx) => `
      <div class="menu-card" style="animation-delay:${idx*0.05}s">
        <div class="card-img">${item.emoji}</div>
        <div class="card-body">
          <div class="card-name">${item.name}</div>
          <div class="card-desc">${item.desc}</div>
          <div class="card-footer">
            <div class="card-price">&#8369;${item.price}</div>
            <button class="add-btn" onclick="addToCart(${item.id})">+</button>
          </div>
        </div>
      </div>`).join('');
  }

  function filterMenu(cat,el) {
    document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
    el.classList.add('active');
    renderMenu(cat);
  }
  renderMenu();

  function addToCart(id) {
    const item=menuItems.find(i=>i.id===id), ex=cart.find(i=>i.id===id);
    if(ex) ex.qty++; else cart.push({...item,qty:1});
    updateCartUI();
    showToast('‚úÖ '+item.name+' added!');
  }

  function removeFromCart(id) {
    const ex=cart.find(i=>i.id===id);
    if(ex.qty>1) ex.qty--; else cart=cart.filter(i=>i.id!==id);
    updateCartUI();
  }

  function getTotal() { return cart.reduce((s,i)=>s+i.price*i.qty,0); }

  function updateCartUI() {
    const count=cart.reduce((s,i)=>s+i.qty,0);
    const el=document.getElementById('cartCount');
    el.textContent=count; el.style.display=count>0?'flex':'none';
    const itemsEl=document.getElementById('cartItems'), formEl=document.getElementById('orderForm');
    if(cart.length===0){
      itemsEl.innerHTML='<div class="empty-cart"><div class="ec-icon">üõí</div>Your cart is empty.<br>Add some items!</div>';
      formEl.style.display='none';
    } else {
      itemsEl.innerHTML=cart.map(i=>`
        <div class="cart-item">
          <div class="ci-emoji">${i.emoji}</div>
          <div class="ci-info">
            <div class="ci-name">${i.name}</div>
            <div class="ci-price">&#8369;${i.price} each</div>
            <div class="ci-qty">
              <button class="qty-btn" onclick="removeFromCart(${i.id})">&#8722;</button>
              <span class="qty-num">${i.qty}</span>
              <button class="qty-btn" onclick="addToCart(${i.id})">+</button>
            </div>
          </div>
          <div style="font-family:'Bebas Neue',sans-serif;font-size:1.2rem;color:var(--yellow);">&#8369;${i.price*i.qty}</div>
        </div>`).join('');
      formEl.style.display='block';
      document.getElementById('totalPrice').textContent='&#8369;'+getTotal().toLocaleString()+'.00';
    }
  }

  function toggleCart() {
    document.getElementById('cartSidebar').classList.toggle('open');
    document.getElementById('cartOverlay').classList.toggle('open');
  }

  // ‚îÄ‚îÄ PLACE ORDER ‚îÄ‚îÄ
  async function placeOrder() {
    const name=document.getElementById('custName').value.trim();
    const phone=document.getElementById('custPhone').value.trim();
    const address=document.getElementById('custAddress').value.trim();
    const note=document.getElementById('custNote').value.trim();
    if(!name||!phone||!address){showToast('‚ö†Ô∏è Please fill in all required fields!');return;}
    if(cart.length===0) return;

    const btn=document.querySelector('.place-order-btn');
    btn.disabled=true; btn.textContent='SENDING...';

    const orderId='CT-'+orderCounter++;
    localStorage.setItem('cessTunaOrderCounter',orderCounter);
    const time=new Date().toLocaleString('en-PH',{timeZone:'Asia/Manila'});
    const total=getTotal();
    const itemsList=cart.map(i=>i.name+' x'+i.qty+' = ‚Ç±'+(i.price*i.qty)).join('\n');
    const newOrder={orderId,name,phone,address,note,items:[...cart],total,time,status:'received'};

    try {
      const getRes=await fetch('https://api.jsonbin.io/v3/b/'+ORDERS_BIN+'/latest',{headers:{'X-Master-Key':API_KEY,'X-Access-Key':API_KEY}});
      const getData=await getRes.json();
      const all=(getData.record&&getData.record.orders)?getData.record.orders:[];
      all.unshift(newOrder);
      await fetch('https://api.jsonbin.io/v3/b/'+ORDERS_BIN,{
        method:'PUT',
        headers:{'Content-Type':'application/json','X-Master-Key':API_KEY,'X-Access-Key':API_KEY},
        body:JSON.stringify({orders:all})
      });
    } catch(e) { console.error(e); }

    emailjs.send(EMAILJS_SERVICE_ID,EMAILJS_TEMPLATE_ID,{
      name,title:orderId,to_email:OWNER_EMAIL,
      order_id:orderId,customer:name,phone,address,
      items:itemsList,total:'‚Ç±'+total.toLocaleString()+'.00',
      note:note||'None',time
    }).catch(()=>{}).finally(()=>{btn.disabled=false;btn.textContent='PLACE ORDER';});

    cart=[]; updateCartUI(); toggleCart();
    ['custName','custPhone','custAddress','custNote'].forEach(id=>document.getElementById(id).value='');
    showToast('üéâ Order '+orderId+' placed!');
    const a=document.getElementById('orderAlert');
    a.classList.add('show'); setTimeout(()=>a.classList.remove('show'),5000);

    // Show tracker
    trackedOrderId=orderId;
    localStorage.setItem('cessTunaTrackedOrder',orderId);
    startTracking();
  }

  // ‚îÄ‚îÄ STATUS TRACKER ‚îÄ‚îÄ
  function startTracking() {
    if(!trackedOrderId) return;
    document.getElementById('stOrderId').textContent='ORDER '+trackedOrderId;
    document.getElementById('statusTracker').classList.add('show');
    updateTrackerUI('received');
    pollStatus();
    if(trackerInterval) clearInterval(trackerInterval);
    trackerInterval=setInterval(pollStatus,6000);
  }

  async function pollStatus() {
    if(!trackedOrderId) return;
    try {
      const res=await fetch('https://api.jsonbin.io/v3/b/'+ORDERS_BIN+'/latest',{headers:{'X-Master-Key':API_KEY,'X-Access-Key':API_KEY}});
      const data=await res.json();
      const orders=(data.record&&data.record.orders)?data.record.orders:[];
      const order=orders.find(o=>o.orderId===trackedOrderId);
      if(order) updateTrackerUI(order.status||'received');
    } catch(e) {}
  }

  function updateTrackerUI(status) {
    const idx=STATUS_STEPS.indexOf(status);
    STATUS_STEPS.forEach((s,i)=>{
      const dot=document.getElementById('dot'+i);
      const lbl=document.getElementById('lbl'+i);
      const line=document.getElementById('line'+i);
      dot.className='st-dot '+(i<idx?'done':i===idx?'active':'');
      lbl.className='st-label '+(i<idx?'done':i===idx?'active':'');
      if(line) line.className='st-line '+(i<idx?'done':'');
    });
    if(status==='delivered'){
      if(trackerInterval) clearInterval(trackerInterval);
      setTimeout(closeTracker,8000);
    }
  }

  function closeTracker() {
    document.getElementById('statusTracker').classList.remove('show');
    trackedOrderId='';
    localStorage.removeItem('cessTunaTrackedOrder');
    if(trackerInterval){clearInterval(trackerInterval);trackerInterval=null;}
  }

  // Resume tracking on page refresh
  if(trackedOrderId) startTracking();

  function showToast(msg) {
    const t=document.getElementById('toast');
    t.textContent=msg; t.classList.add('show');
    setTimeout(()=>t.classList.remove('show'),3500);
  }
</script>
</body>
</html>
